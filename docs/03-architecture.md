# Levelly Architecture

This document explains how the different parts of Levelly connect together and work as a system.

## Table of Contents
- [System Overview](#system-overview)
- [Technology Stack](#technology-stack)
- [Component Architecture](#component-architecture)
- [Data Flow Diagrams](#data-flow-diagrams)
- [Folder Structure](#folder-structure)

---

## System Overview

Think of Levelly like a restaurant:

| Restaurant | Levelly |
|------------|---------|
| The dining area (what customers see) | **Frontend** - The website users interact with |
| The kitchen (where food is prepared) | **Backend** - Processes data and logic |
| The recipe book & ingredient storage | **Database** - Stores all information |
| A special chef who grades taste tests | **AI (OpenAI)** - Grades open-ended answers |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           LEVELLY SYSTEM OVERVIEW                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚     USERS       â”‚
                              â”‚                 â”‚
                              â”‚  ğŸ‘©â€ğŸ« Teachers    â”‚
                              â”‚  ğŸ‘¨â€ğŸ“ Students    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ Browse website
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND (Next.js)                              â”‚
â”‚                                                                              â”‚
â”‚   What users see and interact with:                                          â”‚
â”‚   â€¢ Login/Signup pages                                                       â”‚
â”‚   â€¢ Teacher dashboard                                                        â”‚
â”‚   â€¢ Quiz creation forms                                                      â”‚
â”‚   â€¢ Quiz taking interface                                                    â”‚
â”‚   â€¢ Results page                                                             â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ API calls
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              BACKEND (Next.js API)                           â”‚
â”‚                                                                              â”‚
â”‚   The "brain" that processes everything:                                     â”‚
â”‚   â€¢ Handles user authentication                                              â”‚
â”‚   â€¢ Creates/updates quizzes                                                  â”‚
â”‚   â€¢ Grades MCQ questions instantly                                           â”‚
â”‚   â€¢ Sends open questions to AI for grading                                   â”‚
â”‚   â€¢ Calculates levels                                                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚                        â”‚
                          â”‚                        â”‚
                          â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DATABASE (Supabase)       â”‚    â”‚           AI (OpenAI)            â”‚
â”‚                                   â”‚    â”‚                                  â”‚
â”‚   Stores everything:              â”‚    â”‚   Grades open-ended answers:     â”‚
â”‚   â€¢ Teacher accounts              â”‚    â”‚   â€¢ Reads student response       â”‚
â”‚   â€¢ Quizzes & questions           â”‚    â”‚   â€¢ Understands meaning          â”‚
â”‚   â€¢ Student answers               â”‚    â”‚   â€¢ Assigns score & feedback     â”‚
â”‚   â€¢ Scores & levels               â”‚    â”‚                                  â”‚
â”‚                                   â”‚    â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Technology Stack

### What Each Technology Does

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TECHNOLOGY STACK                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   FRONTEND (What you see)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                         â”‚
   â”‚   Next.js â”€â”€â”€â”€â”€â–º The framework that builds the website                  â”‚
   â”‚      â”‚                                                                  â”‚
   â”‚      â””â”€â”€â–º React â”€â”€â”€â”€â”€â–º Makes pages interactive (buttons, forms, etc.)   â”‚
   â”‚              â”‚                                                          â”‚
   â”‚              â””â”€â”€â–º TypeScript â”€â”€â”€â”€â”€â–º The programming language used       â”‚
   â”‚                        â”‚                                                â”‚
   â”‚                        â””â”€â”€â–º Tailwind CSS â”€â”€â”€â”€â”€â–º Makes things look prettyâ”‚
   â”‚                                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   BACKEND (Behind the scenes)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                         â”‚
   â”‚   Next.js API Routes â”€â”€â”€â”€â”€â–º Handles requests from the frontend          â”‚
   â”‚          â”‚                                                              â”‚
   â”‚          â”œâ”€â”€â–º Authentication â”€â”€â”€â”€â”€â–º Login/logout/signup                 â”‚
   â”‚          â”‚                                                              â”‚
   â”‚          â”œâ”€â”€â–º Quiz Logic â”€â”€â”€â”€â”€â–º Creating, updating, submitting quizzes  â”‚
   â”‚          â”‚                                                              â”‚
   â”‚          â””â”€â”€â–º Grading â”€â”€â”€â”€â”€â–º MCQ (instant) + Open (via AI)              â”‚
   â”‚                                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   DATA STORAGE
   â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                         â”‚
   â”‚   Supabase â”€â”€â”€â”€â”€â–º Cloud database service                                â”‚
   â”‚       â”‚                                                                 â”‚
   â”‚       â”œâ”€â”€â–º PostgreSQL â”€â”€â”€â”€â”€â–º The actual database (stores tables)        â”‚
   â”‚       â”‚                                                                 â”‚
   â”‚       â””â”€â”€â–º Auth â”€â”€â”€â”€â”€â–º Handles teacher login securely                   â”‚
   â”‚                                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   ARTIFICIAL INTELLIGENCE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                         â”‚
   â”‚   OpenAI API â”€â”€â”€â”€â”€â–º The AI service that grades open answers             â”‚
   â”‚       â”‚                                                                 â”‚
   â”‚       â””â”€â”€â–º GPT Model â”€â”€â”€â”€â”€â–º Understands text and provides scores        â”‚
   â”‚                                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Simple Analogies

| Technology | What It's Like |
|------------|----------------|
| **Next.js** | The building that houses everything |
| **React** | The interior design - makes things look good and work well |
| **TypeScript** | The language everyone speaks inside |
| **Tailwind CSS** | The paint and decorations |
| **Supabase** | The filing cabinets storing all documents |
| **OpenAI** | A smart assistant who reads and grades essays |

---

## Component Architecture

### Page Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         WEBSITE PAGE STRUCTURE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              levelly.com
                                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                       â”‚                       â”‚
          â–¼                       â–¼                       â–¼
    PUBLIC PAGES            TEACHER PAGES            QUIZ PAGES
    â•â•â•â•â•â•â•â•â•â•â•â•            â•â•â•â•â•â•â•â•â•â•â•â•â•            â•â•â•â•â•â•â•â•â•â•
          â”‚                       â”‚                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚           â”‚           â”‚           â”‚           â”‚           â”‚
    â–¼           â–¼           â–¼           â–¼           â–¼           â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Home â”‚  â”‚ Login â”‚  â”‚Dashboardâ”‚  â”‚ Quiz   â”‚  â”‚ Take â”‚  â”‚ Results â”‚
 â”‚  /   â”‚  â”‚/login â”‚  â”‚/teacher â”‚  â”‚ Edit   â”‚  â”‚ Quiz â”‚  â”‚/results â”‚
 â”‚      â”‚  â”‚       â”‚  â”‚         â”‚  â”‚        â”‚  â”‚/quiz â”‚  â”‚  /[id]  â”‚
 â”‚      â”‚  â”‚/signupâ”‚  â”‚         â”‚  â”‚/assign-â”‚  â”‚/[tok]â”‚  â”‚         â”‚
 â”‚      â”‚  â”‚       â”‚  â”‚         â”‚  â”‚ments/  â”‚  â”‚      â”‚  â”‚         â”‚
 â”‚      â”‚  â”‚       â”‚  â”‚         â”‚  â”‚ [id]   â”‚  â”‚      â”‚  â”‚         â”‚
 â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”‚           â”‚           â”‚           â”‚           â”‚           â”‚
    â”‚           â”‚           â”‚           â”‚           â”‚           â”‚
    â–¼           â–¼           â–¼           â–¼           â–¼           â–¼
  Anyone     Anyone      Teachers    Teachers    Students    Students
  can see   can access   only        only       (via link)  (after
                         (login                              submit)
                         required)
```

### How Pages Connect to Data

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       PAGE â†’ DATA CONNECTIONS                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   QUIZ PAGE     â”‚          â”‚   API ROUTES    â”‚          â”‚    DATABASE     â”‚
   â”‚  (What student  â”‚   â”€â”€â”€â–º   â”‚  (The middle-   â”‚   â”€â”€â”€â–º   â”‚  (Where data    â”‚
   â”‚   sees)         â”‚          â”‚   man)          â”‚          â”‚   lives)        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   Example Flow - Student takes quiz:
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   1. Student opens quiz link
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Browser shows: /quiz/abc123                                            â”‚
   â”‚                                                                         â”‚
   â”‚  Page needs quiz data, so it calls:                                     â”‚
   â”‚  GET /api/quiz/abc123                                                   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  API Route receives request                                             â”‚
   â”‚                                                                         â”‚
   â”‚  1. Looks up share link "abc123" in database                            â”‚
   â”‚  2. Gets assignment (quiz) details                                      â”‚
   â”‚  3. Gets all questions for this quiz                                    â”‚
   â”‚  4. Returns data to the page                                            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Page displays the quiz with:                                           â”‚
   â”‚  â€¢ Title & description                                                  â”‚
   â”‚  â€¢ All questions                                                        â”‚
   â”‚  â€¢ Answer inputs                                                        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagrams

### Quiz Submission Flow (The Most Complex Part)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    QUIZ SUBMISSION - COMPLETE FLOW                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   STUDENT                    SERVER                    DATABASE              AI
   â•â•â•â•â•â•â•                    â•â•â•â•â•â•                    â•â•â•â•â•â•â•â•              â•â•

      â”‚                          â”‚                          â”‚                  â”‚
      â”‚  1. Submit answers       â”‚                          â”‚                  â”‚
      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                          â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚                          â”‚  2. Create attempt       â”‚                  â”‚
      â”‚                          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚
      â”‚                          â”‚         (new record)     â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚                          â”‚  3. Save all answers     â”‚                  â”‚
      â”‚                          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚                          â”‚  4. Grade MCQs           â”‚                  â”‚
      â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
      â”‚                          â”‚  â”‚ For each MCQ:      â”‚  â”‚                  â”‚
      â”‚                          â”‚  â”‚ â€¢ Compare answer   â”‚  â”‚                  â”‚
      â”‚                          â”‚  â”‚ â€¢ Award points     â”‚  â”‚                  â”‚
      â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
      â”‚                          â”‚         (instant!)       â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚  5. Return MCQ score     â”‚                          â”‚                  â”‚
      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                          â”‚                  â”‚
      â”‚  (Student can see        â”‚                          â”‚                  â”‚
      â”‚   provisional results)   â”‚                          â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚                          â”‚  6. Background: Grade open questions        â”‚
      â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚                          â”‚  â”‚                                       â”‚  â”‚
      â”‚                          â”‚  â”‚  For each open question:              â”‚  â”‚
      â”‚                          â”‚  â”‚                                       â”‚â”€â”€â–ºâ”‚
      â”‚                          â”‚  â”‚  â€¢ Send to AI                         â”‚  â”‚
      â”‚                          â”‚  â”‚                      7. AI analyzes   â”‚  â”‚
      â”‚                          â”‚  â”‚                         and grades    â”‚  â”‚
      â”‚                          â”‚  â”‚                                       â”‚â—„â”€â”¤
      â”‚                          â”‚  â”‚  â€¢ Receive score + feedback           â”‚  â”‚
      â”‚                          â”‚  â”‚                                       â”‚  â”‚
      â”‚                          â”‚  â”‚  â€¢ Save to database â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â”‚
      â”‚                          â”‚  â”‚                                       â”‚  â”‚
      â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚                          â”‚  8. Calculate final levelâ”‚                  â”‚
      â”‚                          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚
      â”‚                          â”‚     (update attempt)     â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚  9. Poll for updates     â”‚                          â”‚                  â”‚
      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                          â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
      â”‚  10. Return final score  â”‚                          â”‚                  â”‚
      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                          â”‚                  â”‚
      â”‚                          â”‚                          â”‚                  â”‚
   â”Œâ”€â”€â”´â”€â”€â”                       â”‚                          â”‚                  â”‚
   â”‚Showsâ”‚                       â”‚                          â”‚                  â”‚
   â”‚finalâ”‚                       â”‚                          â”‚                  â”‚
   â”‚levelâ”‚                       â”‚                          â”‚                  â”‚
   â””â”€â”€â”€â”€â”€â”˜                       â”‚                          â”‚                  â”‚
```

### Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AUTHENTICATION FLOW                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   TEACHER SIGN UP
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Enter   â”‚     â”‚ Supabase â”‚     â”‚  Create  â”‚     â”‚ Redirect â”‚
   â”‚  email,  â”‚â”€â”€â”€â”€â–ºâ”‚  creates â”‚â”€â”€â”€â”€â–ºâ”‚ teacher  â”‚â”€â”€â”€â”€â–ºâ”‚   to     â”‚
   â”‚ password â”‚     â”‚  account â”‚     â”‚  profile â”‚     â”‚dashboard â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


   TEACHER LOGIN
   â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Enter   â”‚     â”‚ Supabase â”‚     â”‚  Create  â”‚     â”‚ Redirect â”‚
   â”‚  email,  â”‚â”€â”€â”€â”€â–ºâ”‚ verifies â”‚â”€â”€â”€â”€â–ºâ”‚ session  â”‚â”€â”€â”€â”€â–ºâ”‚   to     â”‚
   â”‚ password â”‚     â”‚  creds   â”‚     â”‚  cookie  â”‚     â”‚dashboard â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


   ROUTE PROTECTION (Middleware)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   Someone visits /teacher/*
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Check: Is user     â”‚
   â”‚ logged in?         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
       â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
       â”‚           â”‚
      YES          NO
       â”‚           â”‚
       â–¼           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Allow  â”‚  â”‚Redirectâ”‚
   â”‚ access â”‚  â”‚to loginâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Folder Structure

Here's what each folder contains and why:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PROJECT FOLDER STRUCTURE                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

levelly/
â”‚
â”œâ”€â”€ ğŸ“ src/                          â† All source code lives here
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ app/                      â† Pages and routes
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ (root)/               â† Home page
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx             â† What you see at levelly.com/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ api/                  â† Backend API endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ quiz/             â† Quiz-related APIs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ [token]/         â† Get quiz by share link
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ submit/          â† Submit quiz answers
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ attempts/         â† Student attempt APIs
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ assignments/      â† Teacher quiz management
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ auth/                 â† Login callback handling
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ login/                â† Teacher login page
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ signup/               â† Teacher signup page
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ quiz/                 â† Quiz taking pages
â”‚   â”‚   â”‚   â””â”€â”€ [token]/             â† Dynamic quiz page (one per link)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ results/              â† Results viewing
â”‚   â”‚   â”‚   â””â”€â”€ [attemptId]/         â† Dynamic results page
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ teacher/              â† Teacher dashboard & tools
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx             â† Main dashboard
â”‚   â”‚   â”‚   â””â”€â”€ assignments/         â† Quiz management
â”‚   â”‚   â”‚       â”œâ”€â”€ new/             â† Create new quiz
â”‚   â”‚   â”‚       â””â”€â”€ [id]/            â† Edit specific quiz
â”‚   â”‚   â”‚           â””â”€â”€ submissions/ â† View student submissions
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ middleware.ts            â† Route protection (login checks)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ components/               â† Reusable UI pieces
â”‚   â”‚   â””â”€â”€ ui/                      â† Buttons, cards, forms, etc.
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ lib/                      â† Utilities and helpers
â”‚       â”œâ”€â”€ ğŸ“ grading/              â† Grading logic
â”‚       â”‚   â”œâ”€â”€ mcq.ts               â† MCQ grading
â”‚       â”‚   â”œâ”€â”€ open-answer.ts       â† AI grading
â”‚       â”‚   â””â”€â”€ level-calculator.ts  â† Score â†’ Level
â”‚       â”œâ”€â”€ ğŸ“ openai/               â† AI connection
â”‚       â”‚   â””â”€â”€ client.ts            â† OpenAI API wrapper
â”‚       â””â”€â”€ ğŸ“ supabase/             â† Database connection
â”‚           â”œâ”€â”€ client.ts            â† Browser database access
â”‚           â”œâ”€â”€ server.ts            â† Server database access
â”‚           â””â”€â”€ types.ts             â† Data type definitions
â”‚
â”œâ”€â”€ ğŸ“„ package.json                  â† Project dependencies
â”œâ”€â”€ ğŸ“„ tsconfig.json                 â† TypeScript settings
â”œâ”€â”€ ğŸ“„ .env.local                    â† Secret keys (not in git!)
â””â”€â”€ ğŸ“„ README.md                     â† Project documentation
```

### Key Files Explained

| File | What It Does |
|------|--------------|
| `src/app/api/quiz/submit/route.ts` | The main "brain" - handles quiz submission, grading, and leveling |
| `src/lib/grading/open-answer.ts` | Sends answers to AI and gets scores back |
| `src/lib/grading/level-calculator.ts` | Converts percentage score to Beginner/Intermediate/Advanced |
| `src/middleware.ts` | Guards teacher pages - redirects non-logged-in users |
| `src/lib/supabase/types.ts` | Defines the shape of all data in the database |

---

**Previous:** [How It Works](./02-how-it-works.md)
**Next:** [Database](./04-database.md)
